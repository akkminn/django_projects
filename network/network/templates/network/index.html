{% extends "network/layout.html" %}
{% load static %}

{% block body %}

    
        {% if user.is_authenticated %}
            
            <form class="create-post mx-auto" action="{% url 'newpost' %}" method="post">
                {% csrf_token %}
                <input type="text" name="newpost" placeholder="What's on your mind?" required>
                <input type="submit" value="Post" class="btn btn-primary postbtn">
            </form>
        
        {% endif %}
   
    
        {% for post in pages %}
            <div class="feeds mx-auto"></div>
        
                <a href="{% url 'profile' post.user.id %}"><p> {{ post.user }} </p></a>
                <div>
                    <div class="card-text content" id="content{{ post.id }}">{{ post.content }}</div>
                    <p> {{ post.timestamp }} </p>
                </div>

                <div>
                    <div id="likes{{ post.id }}">{{ post.likes.all.count }}</div>
                    Likes
                </div>

                {% if user.is_authenticated %}
                    <button data-postid="{{ post.id }}" class="btn post-btn like">
                        {% if user in post.likes.all %}
                            <script>
                                document.querySelectorAll('button[class]').forEach(btn => {
                                    btn.style.background = 'rgb(32, 120, 244)';
                                    btn.style.color = 'white';
                                });
                            </script>
                            Unlike
                        {% else %}
                            Like
                        {% endif %}
                    </button>
                {% else %}
                    <a class="btn like" style="margin-left: 40px; background: white; border: 1px solid rgb(32, 120, 244); color:rgb(32, 120, 244); display: inline-block;" href="{% url 'login' %}">Like</a>
                {% endif %}

                {% if post.user.id == user.id %}
                    <button style="margin-left: 5px; display: inline;" data-postid="{{ post.id }}" class="btn btn-primary edit-btn edit">Edit
                    </button>
                {% endif %}
                

                {% empty %}
                <p>No posts available</p>

            </div>   
        {% endfor %}
        
    


    {% if pages.has_previous %}
    <div style="width: 100%; display: flex; justify-content: center; align-items: center;">
        <a class="btn btn-primary" style="text-decoration: none;" href="?page={{ pages.previous_page_number }}">Previous page</a>
    </div>
    {% endif %}

    {% if pages.has_next %}
    <div style="width: 100%; display: flex; margin-bottom: 20px; justify-content: center; align-items: center;">
        <a class="btn btn-primary" href="?page={{ pages.next_page_number }}">Next page</a>
    </div>
    {% endif %}

{% endblock %}

{% block script %}
    <script src="{% static 'network/index.js' %}"></script>
{% endblock %}